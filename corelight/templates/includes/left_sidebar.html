
{% load static %}
{% load widget_tweaks %}
{% load avatar_extras %}


<div class="card shadow-sm h-100">
  <div class="card-header bg-primary text-white text-center py-3">
    <h2 class="mb-1" style="font-family: 'MedievalSharp', cursive; font-size: 1.4rem;">
      {{ current_user_data.nickname }} <small>[{{ current_user_data.level }}]</small>
    </h2>
    <hr class="my-2" style="border-color: rgba(255,255,255,0.5);">
    <img src="{% avatar_url current_user_data.avatar_path %}" 
         alt="Аватар {{ current_user_data.nickname }}"
         class="sidebar-avatar-img"><br>
		<div class="text-center mt-2">
		<div style="
				font-family: 'MedievalSharp', cursive;
				font-size: 0.72rem;
				line-height: 1.25;
				color: #333;
				max-width: 180px;
				margin: 0 auto;
			">
				<a href="{% url 'game:sublocation' current_user_data.current_global_location.slug current_user_data.current_sublocation.slug %}"
					style="color: inherit; text-decoration: none;">
					{{ current_user_data.current_global_location.name }}
				</a>
				<div style="color: #5a5a5a; font-size: 0.68rem;">
					<a href="{% url 'game:sublocation' current_user_data.current_global_location.slug current_user_data.current_sublocation.slug %}"
						style="color: inherit; text-decoration: none;">
						→ {{ current_user_data.current_sublocation.name }}
					</a>
				</div>
			</div>
		</div>
		<!-- Полоса здоровья -->
		<div class="mt-3" style="max-width: 200px; margin: 10px auto 0;" title="Текущий уровень здоровья">
			<div style="
				position: relative;
				width: 100%;
				height: 15px;
				background-color: #5a3e1e;
				border: 1px solid #3a2a14;
				border-radius: 4px;
				overflow: hidden;
			">
				{% if current_user_data.max_hp > 0 %}
					{% widthratio current_user_data.current_hp current_user_data.max_hp 100 as hp_percent %}
				{% else %}
					{% with hp_percent=0 %}
					{% endwith %}
				{% endif %}
				<div style="
					position: absolute;
					top: 0;
					left: 0;
					height: 100%;
					width: {{ hp_percent }}%;
					background-color: #4caf50;
				"></div>
				<div style="
					position: absolute;
					top: 0;
					left: 0;
					width: 100%;
					height: 100%;
					display: flex;
					align-items: center;
					justify-content: center;
					font-family: 'MedievalSharp', cursive;
					font-size: 0.65rem;
					color: white;
					text-shadow: 1px 1px 1px rgba(0,0,0,0.7);
					pointer-events: none;
				">
					{{ current_user_data.current_hp }} / {{ current_user_data.max_hp }}
				</div>
			</div>
		</div>
		<!-- Полоса Маны -->
		<!--
		<div class="mt-3" style="max-width: 200px; margin: 10px auto 0;" title="До следующего уровня осталось набрать {{ current_user_data.xp_required_for_level }} опыта.">
			<div style="
				position: relative;
				width: 100%;
				height: 15px;
				background-color: #4a6fa5;
				border: 1px solid #2c3e50;
				border-radius: 4px;
				overflow: hidden;
				">
				{% if current_user_data.xp_required_for_level > 0 %}
					{% widthratio current_user_data.xp_on_this_level current_user_data.xp_required_for_level 100 as xp_percent %}
				{% else %}
					{% with xp_percent=0 %}
					{% endwith %}
				{% endif %}
						<div style="
							position: absolute;
							top: 0;
							left: 0;
							height: 100%;
							width: {{ xp_percent }}%;
							background-color: #4caf50;
						"></div>
						<div style="
							position: absolute;
							top: 0;
							left: 0;
							width: 100%;
							height: 100%;
							display: flex;
							align-items: center;
							justify-content: center;
							font-family: 'MedievalSharp', cursive;
							font-size: 0.65rem;
							color: white;
							text-shadow: 1px 1px 1px rgba(0,0,0,0.7);
							pointer-events: none;
							">
							{{ xp_percent }}%
						</div>
			</div>
		</div> -->

		<!-- Полоса опыта -->
		<div class="mt-3" style="max-width: 200px; margin: 10px auto 0;" title="До следующего уровня осталось набрать {{ current_user_data.xp_for_next_level }} опыта.">
			<div style="
				position: relative;
				width: 100%;
				height: 15px;
				background-color: #5a3e1e;
				border: 1px solid #3a2a14;
				border-radius: 4px;
				overflow: hidden;
				">
				{% if current_user_data.xp_on_this_level > 0 %}
					{% widthratio current_user_data.xp_on_this_level current_user_data.delta_xp_for_levels 100 as xp_percent %}
				{% else %}
					{% with xp_percent=0 %}
					{% endwith %}
				{% endif %}
						<div style="
							position: absolute;
							top: 0;
							left: 0;
							height: 100%;
							width: {{ xp_percent }}%;
							background-color: #d4af37;
						"></div>
						<div style="
							position: absolute;
							top: 0;
							left: 0;
							width: 100%;
							height: 100%;
							display: flex;
							align-items: center;
							justify-content: center;
							font-family: 'MedievalSharp', cursive;
							font-size: 0.65rem;
							color: white;
							text-shadow: 1px 1px 1px rgba(0,0,0,0.7);
							pointer-events: none;
							">
							{{ xp_percent }}%
						</div>
			</div>
		</div>
  </div>

  <div class="card-body ">
    <h3 class="text-center mb-3" style="font-family: 'MedievalSharp', cursive; font-size: 1.2rem; color: var(--text-gold);">
      Характеристики
    </h3>
    
    <!-- Сюда можно добавить статы -->
    <div class="d-flex align-items-start" style="margin: 20px 0; gap: 20px;">
  <!-- Левый столбец -->
  <div style="flex: 1; text-align: left;">
    {% for stat in current_user_data.left_stats %}
      <div 
        class="stat-item py-1"
        data-bs-toggle="tooltip"
        data-bs-html="true"
        title="{{ stat.name }}: {{ stat.desc }}"
        style="
          font-family: 'MedievalSharp', cursive;
          font-size: 0.85rem;
          color: #2c1e0c;
        "
      >
        <strong>{{ stat.name }}:</strong> {{ stat.value }}
      </div>
    {% endfor %}
  </div>

  <!-- Тонкая вертикальная черта -->
  <div style="
    width: 1px;
    background-color: #d5c8a3;
		align-self: stretch;
    margin: 4px 0; /* отступ сверху и снизу */
  "></div>

  <!-- Правый столбец -->
  <div style="flex: 1; text-align: right;">
    {% for stat in current_user_data.right_stats %}
      <div 
        class="stat-item py-1"
        data-bs-toggle="tooltip"
        data-bs-html="true"
        title="{{ stat.desc }}"
        style="
          font-family: 'MedievalSharp', cursive;
          font-size: 0.85rem;
          color: #2c1e0c;
        "
      	>
        <strong>{{ stat.name }}:</strong> {{ stat.value }}
      </div>
    {% endfor %}
  </div>
</div>


  </div>
</div>